01  WS-CA.
    03  WS-P-FLG    PIC X(02).
	88  PROC-ADM-INIT	VALUE '1I'.
	88  PROC-ADM-NEXT	VALUE '1N'.
	88  PROC-USR-INIT	VALUE '2I'.
	88  PROC-USR-NEXT	VALUE '2N'.
    03  WS-ID		PIC X(08).
    03  WS-PWD		PIC X(09).
LINKAGE SECTION.
01  DFHCOMMAREA		PIC X(19).
PROCEDURE DIVISION.
menu program
MOVE SPACES TO WS-CA.
IF Admin Login, SET PROC-ADM-INIT TO TRUE	( Move '1I' TO WS-P-FLG)
IF User  Login, SET PROC-USR-INIT TO TRUE	 (Move '2I' to WS-P-FLG)
XCTL PROGRAM COMMAREA

Login Program =
PROCEDURE DIVISION.
MAIN-PARA.
    IF EIBCALEN = ZERO
	SEND TEXT FROM('CANNOT USE THIS PROG, COME THRU MENU')
	RETURN
    ELSE
	MOVE DFHCOMMAREA TO WS-CA
        PERFORM PROCESS-PARA
    END-IF.
END-PARA.
    RETURN TRANSID COMMAREA
PROCESS-PARA.
    EVALUATE TRUE
	WHEN PROC-ADM-INIT
	   SEND ADM MAP	- Set PROC-ADM-NEXT TO TRUE
	WHEN PROC-USR-INIT
	   SEND USR MAP - Set PROC-USR-NEXT TO TRUE
	WHEN PROC-ADM-NEXT
	   RECV ADM MAP
	WHEN PROC-SUR-NEXT
	   RECV USR MAP
    END-EVALUATE